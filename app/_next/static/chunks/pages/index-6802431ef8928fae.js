(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9536:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(7596)}])},7596:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return F}});var o=i(4246),r=i(4632),t=i(7378),l=i(401),d=function(){var e=(0,t.useContext)(l.I);return{socket:e.socket,setSocket:e.setSocket}},c=i(1666),u=i(3356),s=i(4412);function a(){return(0,s.v9)((function(e){return e.global.mapInfo}))}var v=i(1809),f=i(9225),g=i(8257),p=i(3296),m=i(8070),h=function(){var e=(0,v.Z)(f.Z.useForm(),1)[0],n=d().setSocket;return(0,o.jsxs)(f.Z,{form:e,onFinish:function(e){var i=(0,m.io)(e.origin);n(i)},children:[(0,o.jsx)(f.Z.Item,{name:"origin",children:(0,o.jsx)(g.Z,{placeholder:"Base origin"})}),(0,o.jsx)(p.ZP,{htmlType:"submit",children:"Connect"})]})},x=function(){var e=(0,v.Z)(f.Z.useForm(),1)[0],n=d().socket,i=(0,c.TL)();return(0,o.jsxs)(f.Z,{form:e,onFinish:function(e){n&&((0,s.dC)((function(){i((0,u.ax)(e.gameId)),i((0,u.TG)(e.playerId))})),n.emit("join game",{game_id:e.gameId,player_id:e.playerId}))},children:[(0,o.jsx)(f.Z.Item,{name:"gameId",children:(0,o.jsx)(g.Z,{placeholder:"Game ID"})}),(0,o.jsx)(f.Z.Item,{name:"playerId",children:(0,o.jsx)(g.Z,{placeholder:"Player ID"})}),(0,o.jsx)(p.ZP,{htmlType:"submit",children:"Connect"})]})},j=i(1521),y="1",w="2",b="3",Z="4",k="b",I=function(){var e=d().socket;return(0,j.Z)("uparrow",(function(n){n.preventDefault(),null===e||void 0===e||e.emit("drive player",{direction:b})})),(0,j.Z)("downarrow",(function(n){n.preventDefault(),null===e||void 0===e||e.emit("drive player",{direction:Z})})),(0,j.Z)("leftarrow",(function(){null===e||void 0===e||e.emit("drive player",{direction:y})})),(0,j.Z)("rightarrow",(function(){null===e||void 0===e||e.emit("drive player",{direction:w})})),(0,j.Z)("w",(function(){null===e||void 0===e||e.emit("drive player",{direction:b})})),(0,j.Z)("s",(function(){null===e||void 0===e||e.emit("drive player",{direction:Z})})),(0,j.Z)("a",(function(){null===e||void 0===e||e.emit("drive player",{direction:y})})),(0,j.Z)("d",(function(){null===e||void 0===e||e.emit("drive player",{direction:w})})),(0,j.Z)("space",(function(n){n.preventDefault(),null===e||void 0===e||e.emit("drive player",{direction:k})})),null},_={3:"speed-dragon-egg.png",4:"attack-dragon-egg.png",5:"delay-dragon-egg.png",6:"mystic-dragon-egg.png"},N=i(9432),D=i(7617),E=function(e){var n=e.seconds,i=e.milliseconds;return e.completed?null:(0,o.jsxs)("span",{children:[n,":",i]})},C=function(e){var n=e.col,i=e.rowIndex,r=e.colIndex,l=(0,t.useRef)(null),d=(0,D.Z)(l),c=a(),u=null===c||void 0===c?void 0:c.spoils,s=null===c||void 0===c?void 0:c.players,v=null===c||void 0===c?void 0:c.bombs,f=(0,t.useMemo)((function(){return null===u||void 0===u?void 0:u.find((function(e){return e.row===i&&e.col===r}))}),[i,r,u]),g=(0,t.useMemo)((function(){return null===s||void 0===s?void 0:s.find((function(e){return e.currentPosition.row===i&&e.currentPosition.col===r}))}),[i,r,s]),p=(0,t.useMemo)((function(){return null===v||void 0===v?void 0:v.find((function(e){return e.row===i&&e.col===r}))}),[i,r,v]),m=(0,t.useMemo)((function(){return p?(null===s||void 0===s?void 0:s.find((function(e){return e.id===p.playerId}))).power:0}),[p]),h=(0,t.useMemo)((function(){if(p)return Date.now()+p.remainTime}),[p]);return(0,o.jsxs)("div",{ref:l,className:"flex items-center justify-center bg-cover h-full positive",style:{backgroundImage:"url(/images/tile-".concat(n,".jpg)"),aspectRatio:1},children:[f?(0,o.jsx)("div",{className:"w-full h-full bg-cover",style:{backgroundImage:"url(/images/".concat(_[null===f||void 0===f?void 0:f.spoil_type],")")}}):null,g?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"text-[10px] absolute",style:{userSelect:"none"},children:g.id})}):null,p?(0,o.jsxs)("div",{className:"positive w-full h-full flex items-center justify-center",children:[(0,o.jsx)("div",{style:{width:"40px",height:"40px"},children:(0,o.jsx)("div",{className:"w-full h-full",style:{backgroundImage:"url(/images/bombs.png)",backgroundRepeat:"no-repeat",backgroundPosition:"left top"}})}),(0,o.jsx)("div",{className:"absolute",style:{top:"-20px"},children:(0,o.jsx)(N.ZP,{date:h,intervalDelay:0,precision:2,renderer:E})}),(0,o.jsx)("div",{className:"absolute w-full h-full",style:{backgroundColor:"red",opacity:".4",zIndex:1,width:(null===d||void 0===d?void 0:d.width)+(null===d||void 0===d?void 0:d.width)*m*2,height:null===d||void 0===d?void 0:d.height,left:-(null===d||void 0===d?void 0:d.width)*m}}),(0,o.jsx)("div",{className:"absolute w-full h-full",style:{backgroundColor:"red",opacity:".4",zIndex:1,width:null===d||void 0===d?void 0:d.width,height:(null===d||void 0===d?void 0:d.height)+(null===d||void 0===d?void 0:d.height)*m*2}})]}):null]})},P=function(){var e,n=a();return(0,o.jsx)("div",{children:null===n||void 0===n||null===(e=n.map)||void 0===e?void 0:e.map((function(e,n){return(0,o.jsx)("div",{className:"grid",style:{gridTemplateColumns:"repeat(".concat(e.length,", minmax(0, 1fr))")},children:e.map((function(e,i){return(0,o.jsx)(C,{rowIndex:n,colIndex:i,col:e},i)}))},n)}))})},S=i(5062),T=i(374),M=function(){var e=a(),n=null===e||void 0===e?void 0:e.players;return(0,o.jsx)(S.Z,{className:"mt-3",children:null===n||void 0===n?void 0:n.map((function(e){return(0,o.jsxs)(T.Z,{span:12,children:[(0,o.jsxs)("p",{children:["Player ID: ",e.id]}),(0,o.jsxs)("p",{children:["Health: ",e.lives]}),(0,o.jsxs)("p",{children:["Score: ",e.score]}),(0,o.jsxs)("p",{children:["Box: ",e.box]}),(0,o.jsxs)("p",{children:["Dragon Egg Speed: ",e.dragonEggSpeed]}),(0,o.jsxs)("p",{children:["Dragon Egg Attack: ",e.dragonEggAttack]}),(0,o.jsxs)("p",{children:["Dragon Egg Delay: ",e.dragonEggDelay]}),(0,o.jsxs)("p",{children:["Dragon Egg Mystic: ",e.dragonEggMystic]})]},e.id)}))})},F=function(){var e=d(),n=e.socket,i=e.setSocket,l=(0,s.v9)((function(e){return e.global.connectedServer})),a=(0,s.v9)((function(e){return e.global.connectedGame})),v=(0,c.TL)(),f=(0,s.v9)((function(e){return e.global.playerId})),g=(0,r.Z)((function(e){e.player_id===f&&v((0,u.yb)(!0))})),p=function(){v((0,u.z5)(!0))},m=function(e){v((0,u.Qe)(e.map_info))};return(0,t.useEffect)((function(){if(n)return n.on("join game",g),n.on("connect",p),n.on("ticktack player",m),function(){n.off("join game",g),n.off("connect",p),n.off("ticktack player",m),n.disconnect(),v((0,u.z5)(!0)),i(void 0)}}),[n]),(0,o.jsxs)("main",{children:["Connected: ",l.toString(),!l&&(0,o.jsx)(h,{}),l&&!a&&(0,o.jsx)(x,{}),a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I,{}),(0,o.jsx)(P,{}),(0,o.jsx)(M,{})]})]})}}},function(e){e.O(0,[598,774,888,179],(function(){return n=9536,e(e.s=n);var n}));var n=e.O();_N_E=n}]);